  private requiresAuth(endpoint: string, method: string = 'GET'): boolean {
    // Rotas que REQUEREM autenticação
    const authRequiredRoutes = [
      // Autenticação
      '^/auth/profile$',
      '^/auth/change-password$',
      '^/auth/logout$',
      '^/auth/users',

      // IMPORTANTE: Rotas administrativas que sempre requerem auth + admin role
      '^/orders$', // GET /orders (listar todos os pedidos - apenas admin)
      '^/orders/[^/]+$', // GET /orders/:id (ver detalhes - admin ou próprio usuário)

      // Pedidos do usuário
      '^/orders/my-orders$',
      '^/orders/[^/]+/cancel$',
      '^/orders/[^/]+/reorder$',
      '^/orders/[^/]+/status$',

      // Agendamento de serviços
      '^/services/[^/]+/book$',

      // Upload de imagens (requer autenticação)
      '^/images/upload$',
      '^/images/process$',
      '^/images/crop$',

      // Configurações administrativas (exceto públicas)
      '^/settings/(?!public$|company-info$|category/)',
      '^/settings$', // GET /settings (admin - todas as configurações)

      // PRODUTOS: Apenas rotas administrativas requerem auth
      '^/products/admin/',

      // SERVIÇOS: Apenas rotas administrativas requerem auth
      '^/services/admin/',

      // PROMOÇÕES: Rotas administrativas requerem auth
      '^/promotions/(?!active$|product/|category/|coupons/active$|coupons/validate/)',
      '^/promotions$', // GET /promotions (admin - listar todas)
      '^/promotions/[^/]+$', // GET/PUT/DELETE /promotions/:id (admin)
      '^/promotions/coupons/(?!active$|validate/)',
      '^/promotions/coupons$', // GET /promotions/coupons (admin)
      '^/promotions/coupons/[^/]+$', // operations on specific coupons (admin)

      // IMAGENS: Todas as operações requerem auth
      '^/images/'
    ];

    // Métodos que sempre requerem autenticação (exceto em rotas específicas públicas)
    const authRequiredMethods = ['POST', 'PUT', 'DELETE', 'PATCH'];

    // Se o método requer autenticação e não é uma rota pública específica
    if (authRequiredMethods.includes(method.toUpperCase())) {
      const publicPostRoutes = [
        '^/auth/login$',
        '^/auth/register$',
        '^/auth/refresh$',
        '^/orders$', // Criar pedido como guest (POST /orders)
      ];

      const isPublicPost = publicPostRoutes.some(pattern => {
        const regex = new RegExp(pattern);
        return regex.test(endpoint);
      });

      if (!isPublicPost) {
        return true;
      }
    }

    return authRequiredRoutes.some(pattern => {
      const regex = new RegExp(pattern);
      return regex.test(endpoint);
    });
  }